{"version":3,"file":"index.js","sources":["../src/components/UserWidget/style.ts","../src/components/UserWidget/UserWidget.tsx","../src/helpers/hooks/useOuterClick.ts","../src/components/TextBox/style.ts","../src/components/TextBox/TextBox.tsx","../src/theme/colors.js","../src/theme/typo.js","../src/theme/spacing.js","../src/theme/radius.js","../src/theme/default.js","../src/theme/index.js","../src/index.tsx"],"sourcesContent":["import styled from 'styled-components';\n\nexport const ListBox = styled.div`\n  border-radius: ${({ theme }) => theme.RADIUS.rad6};\n  box-shadow: 0 0\n    ${({ theme }) => theme.TYPO.size.text10 + ' ' + theme.COLORS.shadow};\n  width: ${({ theme }) => theme.SPACING.base * 62}px;\n`;\n\nexport const UserList = styled.ul`\n  list-style: none;\n  padding-inline-start: 0;\n  margin: 0;\n`;\n\ninterface ListProps {\n  selected: boolean;\n}\n\nexport const UserListItem = styled.li<ListProps>`\n  display: flex;\n  padding: ${({ theme }) => theme.SPACING.base * 2}px\n    ${({ theme }) => theme.SPACING.base}px;\n  background: ${({ selected, theme }) =>\n    !selected ? theme.COLORS.background : theme.COLORS.highlight};\n  img {\n    height: ${({ theme }) => theme.SPACING.base * 8}px;\n    border-radius: 50%;\n    margin-right: ${({ theme }) => theme.TYPO.size.text10};\n  }\n  h3 {\n    line-height: ${({ theme }) => theme.SPACING.base * 8}px;\n    margin: 0;\n    font-weight: ${({ theme }) => theme.TYPO.weight.semiBold};\n    font-size: ${({ theme }) => theme.TYPO.size.text14};\n  }\n  h5 {\n    font-weight: ${({ theme }) => theme.TYPO.weight.semiBold};\n    margin: 0;\n    font-size: ${({ theme }) => theme.TYPO.size.text12};\n    line-height: ${({ theme }) => theme.SPACING.base * 8}px;\n    color: ${({ theme }) => theme.COLORS.fontSecondary};\n  }\n`;\n","import React, { useEffect, useState } from 'react';\nimport { ListBox, UserList, UserListItem } from './style';\n\ninterface UserObject {\n  username: string;\n  avatar_url: string;\n  name: string;\n}\n\ninterface Props {\n  userList: Array<UserObject>;\n  searchTerm: string;\n  wrapperRef: React.RefObject<any>;\n  cancelSearch: () => void;\n  selectUser: (v: string) => void;\n}\n\nconst UserWidget = ({\n  userList,\n  searchTerm,\n  wrapperRef,\n  cancelSearch,\n  selectUser\n}: Props) => {\n  // Filter user list with the search term\n  const filteredList = userList.filter(\n    (item) =>\n      (item.username.toLowerCase().indexOf(searchTerm) > -1 ||\n        item.name.toLowerCase().indexOf(searchTerm) > -1) &&\n      item\n  );\n\n  const selectOnClick = (listIndex: number) => {\n    selectUser(filteredList[listIndex].username);\n  };\n\n  const [highlighted, setHighlighted] = useState(-1);\n\n  useEffect(() => {\n    //  handle key press event like esc to cacnel the display of the list\n    const handleKeyPress = (e: React.KeyboardEvent<any>) => {\n      const keyInput = e.key;\n      // if users hits ESC reset search\n      if (keyInput === 'Escape') {\n        cancelSearch();\n      }\n      // select highlighted user\n      if (keyInput === 'Tab' || keyInput === 'Enter') {\n        e.preventDefault();\n        const selectIndex = highlighted < 0 ? 0 : highlighted;\n        selectUser(filteredList[selectIndex].username);\n      }\n      const listLength = filteredList.length;\n      // highliht users\n      if (keyInput === 'ArrowDown') {\n        e.preventDefault();\n        const next = highlighted + 1;\n        setHighlighted(next >= listLength ? next % listLength : next);\n      }\n      if (keyInput === 'ArrowUp') {\n        e.preventDefault();\n        const next = highlighted > -1 ? highlighted - 1 : listLength - 1;\n        setHighlighted(next >= listLength ? next % listLength : next);\n      }\n    };\n\n    const wrapper = wrapperRef;\n    // bind event listener on key down\n    wrapper.current.addEventListener('keydown', handleKeyPress);\n    // Unbind the event listener on clean up\n    return () => {\n      if (wrapper.current) {\n        wrapper.current.removeEventListener('keydown', handleKeyPress);\n      }\n    };\n  }, [wrapperRef, cancelSearch, filteredList, selectUser, highlighted]);\n\n  // If no results do not show the list\n  if (!filteredList.length) {\n    return null;\n  }\n\n  return (\n    <ListBox>\n      <UserList title='Tag User'>\n        {filteredList.map(({ username, avatar_url, name }, key) => (\n          <UserListItem\n            selected={key === highlighted}\n            key={key}\n            onClick={() => selectOnClick(key)}\n            onMouseOver={() => setHighlighted(key)}\n          >\n            <img src={avatar_url} alt={username} />\n            <h3>{name}</h3>\n            <h5>~@{username}</h5>\n          </UserListItem>\n        ))}\n      </UserList>\n    </ListBox>\n  );\n};\n\nexport default UserWidget;\n","import { useEffect, useState } from 'react';\n\nfunction useOuterClick(innerRef: React.RefObject<any>) {\n  const [isOuter, setIsOuter] = useState(false);\n\n  useEffect(() => {\n    // handle click if clicked outside\n    const handleClickOutside = (event: MouseEvent) => {\n      if (innerRef.current && !innerRef.current.contains(event.target)) {\n        setIsOuter(true);\n      }\n    };\n    // Bind the event listener\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [innerRef, isOuter]);\n\n  return { isOuter, setIsOuter };\n}\n\nexport default useOuterClick;\n","import styled from 'styled-components';\n\nexport const TextBoxWrapper = styled.div`\n  display: flex;\n  justify-content: center;\n  font-family: ${({ theme }) => theme.TYPO.fontFamilly.primary};\n`;\n\nexport const TextLabel = styled.label`\n  color: ${({ theme }) => theme.COLORS.fontPrimary};\n`;\nexport const TextArea = styled.textarea`\n  font-family: inherit;\n  display: block;\n  resize: none;\n  background: ${({ theme }) => theme.COLORS.background};\n  height: ${({ theme }) => theme.SPACING.base * 20}px;\n  width: ${({ theme }) => theme.SPACING.base * 60}px;\n  font-size: ${({ theme }) => theme.TYPO.size.text14};\n  padding: ${({ theme }) => theme.SPACING.base}px;\n  border-radius: ${({ theme }) => theme.SPACING.base}px;\n  border: none;\n  box-shadow: 0 0\n    ${({ theme }) => theme.TYPO.size.text10 + ' ' + theme.COLORS.shadow};\n  margin-top: ${({ theme }) => theme.SPACING.base * 2}px;\n  &:focus {\n    outline: none;\n  }\n`;\n\nexport const Submit = styled.button`\n  margin-top: ${({ theme }) => theme.SPACING.base}px;\n  padding ${({ theme }) => theme.SPACING.base * 2}px ${({ theme }) =>\n  theme.SPACING.base * 3}px;\n  background: ${({ theme }) => theme.COLORS.submitButton};\n  border: none;\n  color: ${({ theme }) => theme.COLORS.background};\n  text-align: center;\n  text-decoration: none;\n  font-size: ${({ theme }) => theme.TYPO.size.text14};\n`;\n","import React, { useState, useRef, useEffect } from 'react';\nimport UserWidget from '../UserWidget';\nimport useOuterClick from '../../helpers/hooks/useOuterClick';\nimport { TextBoxWrapper, TextLabel, TextArea, Submit } from './style';\n\ninterface UserObject {\n  username: string;\n  avatar_url: string;\n  name: string;\n}\n\ninterface LabelsObject {\n  label: string;\n  placeholder: string;\n  submit: string;\n}\n\ntype Props = {\n  userObjects: UserObject[];\n  onSubmitAction?: (v: { text: string; tagged: Array<any> }) => void;\n  labels: LabelsObject;\n};\n\nconst TextBox = ({ userObjects, onSubmitAction, labels }: Props) => {\n  const [searchStarted, setSearchStarted] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [textAreaValue, setTextAreaValue] = useState('');\n  const innerRef = useRef(null);\n  const { isOuter, setIsOuter } = useOuterClick(innerRef);\n  const [selectedUser, setSelectedUser] = useState('');\n  const [tagged, setTagged] = useState(['']);\n  const { label, placeholder, submit } = labels;\n  // resets state to default\n  const cancelSearch = () => {\n    setSearchStarted(false);\n    setSearchTerm('');\n  };\n  const handleSubmit = () => {\n    if (onSubmitAction) {\n      onSubmitAction({\n        text: textAreaValue,\n        tagged: tagged.length > 1 ? tagged.filter((a) => a !== '') : tagged\n      });\n    }\n\n    setTagged([]);\n    setTextAreaValue('');\n  };\n  // handle typing so we can display filtered list with as few possible re-rendes\n  // another implementation would be with useEffect\n  const handleTyping = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const userSearch = e.target.value;\n    setTextAreaValue(userSearch);\n    if (userSearch.indexOf('@') > -1) {\n      setSearchStarted(true);\n    }\n    // if @ is delted cancel search\n    if (userSearch.indexOf('@') === -1 && searchStarted) {\n      cancelSearch();\n    }\n    // add search term to the state\n    if (userSearch.indexOf('@') > -1) {\n      const searchArr = userSearch.split('@');\n      setSearchTerm(\n        searchArr[searchArr.length - 1]\n          ? searchArr[searchArr.length - 1].toLowerCase()\n          : searchArr[1].toLowerCase()\n      );\n    }\n  };\n\n  useEffect(() => {\n    // if clicked outside of wrapper remove user list\n    if (isOuter) {\n      cancelSearch();\n      setIsOuter(false);\n    }\n  }, [isOuter, setIsOuter]);\n\n  useEffect(() => {\n    if (selectedUser !== '') {\n      const regex = new RegExp(`@${searchTerm}`, 'ig');\n      const comment = textAreaValue.replace(regex, `${selectedUser}`);\n      setTagged([...tagged, selectedUser]);\n      setTextAreaValue(comment);\n      setSelectedUser('');\n      cancelSearch();\n    }\n  }, [\n    selectedUser,\n    setSelectedUser,\n    textAreaValue,\n    setTextAreaValue,\n    searchTerm,\n    tagged\n  ]);\n\n  return (\n    <TextBoxWrapper ref={innerRef} tabIndex={0}>\n      <TextLabel htmlFor='comment-field'>\n        {label}\n        <TextArea\n          placeholder={placeholder}\n          value={textAreaValue}\n          onChange={handleTyping}\n          id='comment-field'\n        />\n        {onSubmitAction && !searchStarted && (\n          <Submit onClick={handleSubmit}>{submit}</Submit>\n        )}\n        {searchStarted && (\n          <UserWidget\n            selectUser={setSelectedUser}\n            wrapperRef={innerRef}\n            searchTerm={searchTerm}\n            userList={userObjects}\n            cancelSearch={cancelSearch}\n          />\n        )}\n      </TextLabel>\n    </TextBoxWrapper>\n  );\n};\n\nexport default TextBox;\n","const COLORS = {\n  background: '#ffffff',\n  highlight: '#D8DADF',\n  submitButton: '#5004D9',\n  fontPrimary: '#000',\n  fontSecondary: 'gray',\n  shadow: '#888'\n};\n\nexport default COLORS;\n","const TYPO = {\n  fontFamilly: {\n    primary: 'Arial, Helvetica, sans-serif'\n  },\n  size: {\n    // ${({ theme }) => theme.TYPO.size.*}\n    text5: '5px',\n    text10: '10px',\n    text12: '12px',\n    text14: '14px',\n    text16: '16px'\n  },\n  weight: {\n    // ${({ theme }) => theme.TYPO.weight.*}\n    light: 300,\n    normal: 400,\n    semiBold: 600,\n    bold: 700,\n    extraBold: 800,\n    black: 900\n  },\n  transform: {\n    // ${({ theme }) => theme.TYPO.transform.*}\n    lowerCase: 'lowercase',\n    none: 'none',\n    upperCase: 'uppercase'\n  }\n};\n\nexport default TYPO;\n","const SPACING = {\n  base: 5 // Usage -> ${({ theme }) => theme.SPACING.base * n}px\n};\n\nexport default SPACING;\n","const RADIUS = {\n  // ${({ theme }) => theme.RADIUS.rad*}\n  rad4: '4px',\n  rad6: '6px',\n  rad8: '8px',\n  rad25: '25px'\n};\n\nexport default RADIUS;\n","import COLORS from './colors';\nimport TYPO from './typo';\nimport SPACING from './spacing';\nimport RADIUS from './radius';\n\nconst defaults = {\n  COLORS,\n  TYPO,\n  SPACING,\n  RADIUS\n};\n\nexport default defaults;\n","import defaults from './default';\n\nconst theme = defaults;\n\nexport default theme;\n","import * as React from 'react';\nimport TextBox from './components/TextBox';\nimport { ThemeProvider } from 'styled-components';\nimport theme from './theme';\n\ninterface ThemeProps {\n  COLORS?: Object;\n  TYPO?: Object;\n  SPACING?: Object;\n  RADIUS?: Object;\n}\n\ninterface LabelsObject {\n  label: string;\n  placeholder: string;\n  submit: string;\n}\n\ninterface UserObject {\n  username: string;\n  avatar_url: string;\n  name: string;\n}\nconst defalutProps = {\n  labels: {\n    label: 'Write your comment:',\n    placeholder: 'Remember, be nice!',\n    submit: 'Submit'\n  },\n  userObjects: [\n    {\n      username: 'df-username',\n      avatar_url:\n        'https://secure.gravatar.com/avatar/f04241571d95d005e4a54f4278670718?d=mm',\n      name: 'John Doe'\n    },\n    {\n      username: 'df-username2',\n      avatar_url:\n        'https://secure.gravatar.com/avatar/f04241571d95d005e4a54f4278670718?d=mm',\n      name: 'John Doe 2'\n    },\n    {\n      username: 'df-username3',\n      avatar_url:\n        'https://secure.gravatar.com/avatar/f04241571d95d005e4a54f4278670718?d=mm',\n      name: 'John Doe 3'\n    }\n  ]\n};\n\ntype Props = {\n  themeOptions?: ThemeProps;\n  onSubmit: (v: any) => void;\n  labels?: LabelsObject;\n  userObjects: UserObject[];\n} & typeof defalutProps;\n\nconst CommentBox = ({ userObjects, themeOptions, onSubmit, labels }: Props) => {\n  if (themeOptions && typeof themeOptions === 'object') {\n    Object.keys(themeOptions).forEach((i) => {\n      theme[i] = { ...theme[i], ...themeOptions[i] };\n    });\n  }\n\n  return (\n    <ThemeProvider theme={theme}>\n      <TextBox\n        userObjects={userObjects}\n        labels={labels}\n        onSubmitAction={onSubmit}\n      />\n    </ThemeProvider>\n  );\n};\n\nCommentBox.defaultProps = defalutProps;\n\nexport default CommentBox;\n"],"names":["ListBox","styled","div","theme","RADIUS","rad6","TYPO","size","text10","COLORS","shadow","SPACING","base","UserList","ul","UserListItem","li","selected","background","highlight","weight","semiBold","text14","text12","fontSecondary","UserWidget","userList","searchTerm","wrapperRef","cancelSearch","selectUser","filteredList","filter","item","username","toLowerCase","indexOf","name","selectOnClick","listIndex","useState","highlighted","setHighlighted","useEffect","handleKeyPress","e","keyInput","key","preventDefault","selectIndex","listLength","length","next","wrapper","current","addEventListener","removeEventListener","React","title","map","avatar_url","onClick","onMouseOver","src","alt","useOuterClick","innerRef","isOuter","setIsOuter","handleClickOutside","event","contains","target","document","TextBoxWrapper","fontFamilly","primary","TextLabel","label","fontPrimary","TextArea","textarea","Submit","button","submitButton","TextBox","userObjects","onSubmitAction","labels","searchStarted","setSearchStarted","setSearchTerm","textAreaValue","setTextAreaValue","useRef","selectedUser","setSelectedUser","tagged","setTagged","placeholder","submit","handleSubmit","text","a","handleTyping","userSearch","value","searchArr","split","regex","RegExp","comment","replace","ref","tabIndex","htmlFor","onChange","id","text5","text16","light","normal","bold","extraBold","black","transform","lowerCase","none","upperCase","rad4","rad8","rad25","defaults","defalutProps","CommentBox","themeOptions","onSubmit","Object","keys","forEach","i","ThemeProvider","defaultProps"],"mappings":"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"}